# ğŸš€ æ™ºèƒ½è·¯ç”±ç®¡ç†å·¥å…·è¿è¡ŒæŒ‡å—

## âœ… é—®é¢˜å·²ä¿®å¤ï¼

ç½‘å…³æ£€æµ‹é—®é¢˜å·²ç»è§£å†³ï¼Œç¨‹åºç°åœ¨å¯ä»¥æ­£ç¡®è¯†åˆ«VPNç¯å¢ƒä¸‹çš„ç‰©ç†ç½‘å…³ã€‚

## ğŸ¯ å½“å‰çŠ¶æ€

- **ç¨‹åºç‰ˆæœ¬**: Smart Route Manager v1.0.0
- **æ£€æµ‹åˆ°çš„ç‰©ç†ç½‘å…³**: 192.168.32.1 (en0æ¥å£)
- **ä¸­å›½è·¯ç”±æ•°é‡**: 8,690æ¡ç½‘ç»œè§„åˆ™
- **ä¸­å›½DNSæœåŠ¡å™¨**: 4ä¸ª
- **ç¼–è¯‘çŠ¶æ€**: âœ… æˆåŠŸ
- **é…ç½®æµ‹è¯•**: âœ… é€šè¿‡

## ğŸš€ ç«‹å³å¼€å§‹ä½¿ç”¨

### 1. ä¸€æ¬¡æ€§è·¯ç”±è®¾ç½®ï¼ˆæ¨èå…ˆè¯•ç”¨ï¼‰

```bash
sudo ./smartroute
```

è¿™ä¼šï¼š
- ä¸ºæ‰€æœ‰8690ä¸ªä¸­å›½IPæ®µè®¾ç½®ç›´è¿è·¯ç”±
- ä¸º4ä¸ªä¸­å›½DNSæœåŠ¡å™¨è®¾ç½®ç›´è¿è·¯ç”±
- ä½¿ç”¨æ£€æµ‹åˆ°çš„ç½‘å…³ 192.168.32.1
- å®Œæˆåæ˜¾ç¤ºæ“ä½œç»“æœ

### 2. å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼ˆè‡ªåŠ¨ç›‘æ§ç½‘ç»œå˜åŒ–ï¼‰

```bash
sudo ./smartroute daemon
```

é¢„æœŸè¾“å‡ºç¤ºä¾‹ï¼š
```json
{"time":"2025-08-25T10:35:00.123456+08:00","level":"INFO","msg":"service starting","version":"1.0.0","pid":"12345"}
{"time":"2025-08-25T10:35:00.234567+08:00","level":"INFO","msg":"configuration loaded","config_file":"configs/config.json","chn_routes":8690,"chn_dns":4}
{"time":"2025-08-25T10:35:01.345678+08:00","level":"INFO","msg":"setting up routes","gateway":"192.168.32.1","total":8694}
{"time":"2025-08-25T10:35:05.456789+08:00","level":"INFO","msg":"batch operation completed","action":"add","total":8694,"success":8694,"failed":0,"duration_ms":4111}
{"time":"2025-08-25T10:35:05.567890+08:00","level":"INFO","msg":"network monitor started","poll_interval":"5s"}
```

### 3. ç³»ç»ŸæœåŠ¡å®‰è£…ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

```bash
# å®‰è£…ä¸ºç³»ç»ŸæœåŠ¡
sudo ./smartroute install

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./smartroute status

# å¦‚éœ€å¸è½½
sudo ./smartroute uninstall
```

## ğŸ“Š éªŒè¯åˆ†æµæ•ˆæœ

### æ£€æŸ¥è·¯ç”±æ˜¯å¦ç”Ÿæ•ˆ

```bash
# æŸ¥çœ‹ä¸­å›½IPè·¯ç”±ï¼ˆåº”è¯¥èµ°en0ï¼‰
route -n get 223.5.5.5
# åº”è¯¥æ˜¾ç¤º: gateway: 192.168.32.1, interface: en0

# æŸ¥çœ‹å›½å¤–IPè·¯ç”±ï¼ˆåº”è¯¥èµ°VPNï¼‰
route -n get 8.8.8.8  
# åº”è¯¥æ˜¾ç¤º: interface: utun6
```

### æµ‹è¯•ç½‘ç»œè¿æ¥

```bash
# æµ‹è¯•ä¸­å›½ç½‘ç«™ï¼ˆåº”è¯¥ç›´è¿ï¼‰
curl -s -w "%{time_total}s - %{remote_ip}\n" -o /dev/null https://www.baidu.com

# æµ‹è¯•å›½å¤–ç½‘ç«™ï¼ˆåº”è¯¥èµ°VPNï¼‰
curl -s -w "%{time_total}s - %{remote_ip}\n" -o /dev/null https://www.google.com
```

## ğŸ”§ é…ç½®æ–‡ä»¶è‡ªå®šä¹‰

ç¼–è¾‘ `configs/config.json` æ¥è°ƒæ•´è®¾ç½®ï¼š

```json
{
    "log_level": "info",          // debug, info, warn, error
    "silent_mode": false,         // æ˜¯å¦é™é»˜è¿è¡Œ
    "daemon_mode": false,         // å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼
    "monitor_interval": "5s",     // ç½‘ç»œç›‘æ§é—´éš”
    "retry_attempts": 3,          // é‡è¯•æ¬¡æ•°
    "concurrency_limit": 50,      // å¹¶å‘é™åˆ¶
    "batch_size": 100            // æ‰¹å¤„ç†å¤§å°
}
```

## ğŸ® é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰é…ç½®è¿è¡Œ

```bash
# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
sudo ./smartroute --config /path/to/config.json

# é™é»˜æ¨¡å¼ï¼ˆæ— è¾“å‡ºï¼‰
sudo ./smartroute --silent

# å®ˆæŠ¤è¿›ç¨‹ + è‡ªå®šä¹‰é…ç½®
sudo ./smartroute daemon --config configs/config.json
```

### ä½¿ç”¨Makefileï¼ˆæ¨èï¼‰

```bash
# ä¸€æ¬¡æ€§è®¾ç½®
make run

# å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼
make daemon

# æµ‹è¯•é…ç½®
make test-config

# å®‰è£…æœåŠ¡
make install

# æŸ¥çœ‹çŠ¶æ€
make status
```

## ğŸš¨ é‡è¦æç¤º

1. **VPNå…¼å®¹æ€§**: ç¨‹åºå·²ä¼˜åŒ–æ”¯æŒWireGuardç­‰VPNç¯å¢ƒ
2. **ç½‘ç»œä¸­æ–­**: å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ä¼šè‡ªåŠ¨å¤„ç†ç½‘ç»œå˜åŒ–
3. **æƒé™è¦æ±‚**: æ‰€æœ‰è·¯ç”±æ“ä½œéƒ½éœ€è¦rootæƒé™
4. **å¤‡ä»½å»ºè®®**: é¦–æ¬¡ä½¿ç”¨å‰å»ºè®®å¤‡ä»½è·¯ç”±è¡¨

## ğŸ“ˆ æ€§èƒ½é¢„æœŸ

åŸºäºä½ çš„ç½‘ç»œç¯å¢ƒï¼š
- **è®¾ç½®8694æ¡è·¯ç”±è§„åˆ™é¢„è®¡è€—æ—¶**: 3-5ç§’
- **å†…å­˜å ç”¨**: çº¦40-60MB
- **CPUä½¿ç”¨**: è®¾ç½®æœŸé—´2-5%ï¼Œç›‘æ§æ—¶<1%

## ğŸ” æ•…éšœæ’æŸ¥

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

```bash
# 1. æ£€æŸ¥ç½‘ç»œçŠ¶æ€
./smartroute version

# 2. éªŒè¯é…ç½®
./smartroute test

# 3. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
sudo ./smartroute daemon  # è§‚å¯Ÿè¾“å‡º

# 4. æ£€æŸ¥è·¯ç”±è¡¨
netstat -rn | head -20
```

## ğŸ‰ å‡†å¤‡å°±ç»ªï¼

ä½ çš„æ™ºèƒ½è·¯ç”±ç®¡ç†å·¥å…·å·²ç»å®Œå…¨é…ç½®å¥½ï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨äº†ï¼

**æ¨èé¦–æ¬¡ä½¿ç”¨æ­¥éª¤**ï¼š
1. `sudo ./smartroute` - ä¸€æ¬¡æ€§è®¾ç½®ï¼ŒéªŒè¯æ•ˆæœ
2. `sudo ./smartroute daemon` - å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹
3. `sudo ./smartroute install` - å¦‚æœæ•ˆæœæ»¡æ„ï¼Œå®‰è£…ä¸ºç³»ç»ŸæœåŠ¡

ç°åœ¨å°±å¯ä»¥äº«å—æ™ºèƒ½åˆ†æµå¸¦æ¥çš„ç½‘ç»œåŠ é€Ÿæ•ˆæœäº†ï¼ğŸš€